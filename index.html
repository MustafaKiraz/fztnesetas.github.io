<!DOCTYPE html>
<html lang="tr" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fizyoterapist Neşe Taş - Profesyonel Fizyoterapi</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Google Fonts: Poppins -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <!-- Quill Rich Text Editor Kütüphanesi -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>

    <style>
        body {
            font-family: 'Poppins', sans-serif;
            color: #374151;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            background-color: #fdfdff;
            background-image: radial-gradient(at 5% 10%, hsla(339, 71%, 91%, 0.35) 0px, transparent 50%), radial-gradient(at 95% 90%, hsla(174, 100%, 29%, 0.2) 0px, transparent 50%), radial-gradient(at 50% 50%, hsla(0, 0%, 100%, 0.5) 0px, transparent 40%);
            background-attachment: fixed;
        }
        :root {
            --primary-color: #009688; --primary-color-light: #00bfa5; --text-color-dark: #1f2937; --text-color-light: #6b7280; --bg-light: #ffffff; --border-color: #e5e7eb;
        }
        .page { display: none; animation: fadeInUp 0.6s ease-in-out; }
        @keyframes fadeInUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .modal { display: none; position: fixed; z-index: 201; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6); animation: fadeIn 0.3s; }
        .modal-content { background-color: var(--bg-light); margin: 5% auto; padding: 2rem; border-radius: 12px; width: 90%; animation: scaleUp 0.4s ease-out; }
        .close-button { color: #aaa; float: right; font-size: 28px; font-weight: bold; cursor: pointer; transition: color 0.2s; }
        .close-button:hover, .close-button:focus { color: var(--text-color-dark); }
        .btn { padding: 12px 28px; border-radius: 8px; font-weight: 600; transition: all 0.3s ease; display: inline-block; border: none; text-align: center; }
        .btn-primary { background-image: linear-gradient(to right, var(--primary-color-light) 0%, var(--primary-color) 51%, var(--primary-color-light) 100%); background-size: 200% auto; color: white; }
        .btn-primary:hover { background-position: right center; transform: translateY(-3px); box-shadow: 0 4px 15px rgba(0, 150, 136, 0.25); }
        .btn-primary:disabled { background-image: none; background-color: #9ca3af; cursor: not-allowed; }
        .btn-secondary { background-color: var(--bg-light); color: var(--primary-color); border: 1px solid var(--border-color); }
        .btn-secondary:hover { background-color: #f3f4f6; border-color: #d1d5db; }
        .nav-link { position: relative; color: var(--text-color-light); font-weight: 500; padding: 8px 4px; transition: color 0.3s; }
        .nav-link:hover { color: var(--primary-color); }
        .nav-link::after { content: ''; position: absolute; width: 0; height: 2px; bottom: -6px; left: 0; background-color: var(--primary-color); transition: width 0.3s ease; }
        .nav-link:hover::after, .nav-link.active::after { width: 100%; }
        .nav-link.active { color: var(--primary-color); }
        .form-input { width: 100%; padding: 14px 16px; border: 1px solid var(--border-color); border-radius: 8px; background-color: #fdfdff; transition: all 0.3s; font-size: 16px; }
        .form-input:focus { outline: none; border-color: var(--primary-color); background-color: white; box-shadow: 0 0 0 3px rgba(0, 150, 136, 0.1); }
        .char-counter { font-size: 0.75rem; color: #6b7280; text-align: right; margin-top: 2px; }
        .char-counter.limit-exceeded { color: #ef4444; font-weight: 600; }
        .admin-panel-base { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); z-index: 200; width: 90%; background: white; border-radius: 12px; padding: 2rem; box-shadow: 0 10px 40px rgba(0,0,0,0.15); }
        .admin-panel-base-scrollable { max-height: 80vh; overflow-y: auto; }
        #admin-panel, #service-panel, #home-edit-panel, #about-edit-panel, #contact-edit-panel { max-width: 700px; }
        #edit-post-panel, #delete-post-panel, #edit-service-panel, #delete-service-panel { max-width: 600px; }
        .card { background-color: rgba(255, 255, 255, 0.7); backdrop-filter: blur(10px); -webkit-backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.3); border-radius: 16px; box-shadow: 0 4px 30px rgba(0, 0, 0, 0.1); transition: all 0.3s ease; }
        .card:hover { transform: translateY(-5px); box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.08), 0 4px 6px -4px rgb(0 0 0 / 0.08); }
        .text-primary { color: var(--primary-color); }
        .notification { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); padding: 12px 24px; border-radius: 8px; z-index: 1001; opacity: 0; transition: opacity 0.3s, top 0.3s; box-shadow: 0 4px 15px rgba(0,0,0,0.1); font-weight: 500; color: white; }
        .notification.show { opacity: 1; top: 40px; }
        #editor-container { background-color: #fdfdff; }
        .ql-toolbar.ql-snow { border-radius: 8px 8px 0 0; border-color: var(--border-color); }
        .ql-container.ql-snow { border-radius: 0 0 8px 8px; border-color: var(--border-color); min-height: 150px; font-size: 16px; }
        .ql-editor { padding: 14px 16px; }
        #admin-panel .ql-toolbar.ql-snow, #admin-panel .ql-container.ql-snow { transition: all 0.3s; }
        #admin-panel .ql-container.ql-snow:focus-within { border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(0, 150, 136, 0.1); }
        #admin-panel .ql-toolbar.ql-snow:focus-within { border-color: var(--primary-color); box-shadow: 0 0 0 3px rgba(0, 150, 136, 0.1); border-bottom-color: var(--border-color);}
        .whatsapp-fab { position: fixed; bottom: 25px; right: 25px; width: 60px; height: 60px; background-color: #25D366; color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 30px; box-shadow: 0 4px 12px rgba(0,0,0,0.2); z-index: 100; transition: transform 0.2s ease-in-out; }
        .whatsapp-fab:hover { transform: scale(1.1); }
        .skeleton { background-color: #e5e7eb; border-radius: 0.375rem; }
    </style>
</head>
<body>

    <!-- Header & Navigation -->
    <header class="bg-white/70 backdrop-blur-lg sticky top-0 z-50 border-b border-gray-200/80">
        <nav class="container mx-auto px-6 py-4 flex justify-between items-center">
            <a href="#home" class="text-2xl font-bold text-gray-800 page-link">Fizyoterapist Neşe Taş</a>
            <ul class="hidden md:flex items-center space-x-8">
                <li><a href="#home" class="nav-link page-link active">Ana Sayfa</a></li>
                <li><a href="#about" class="nav-link page-link">Hakkımda</a></li>
                <li><a href="#services" class="nav-link page-link">Hizmetler</a></li>
                <li><a href="#blog" class="nav-link page-link">Blog</a></li>
                <li><a href="#contact" class="nav-link page-link">İletişim</a></li>
            </ul>
            <a href="#appointment" class="hidden md:inline-block btn btn-primary page-link">Randevu Al</a>
            <button id="mobile-menu-button" class="md:hidden text-gray-800"><i class="fas fa-bars fa-xl"></i></button>
        </nav>
        <div id="mobile-menu" class="hidden md:hidden bg-white/90 backdrop-blur-lg border-t border-gray-200/80">
            <ul class="flex flex-col items-center space-y-4 py-4">
                <li><a href="#home" class="nav-link page-link">Ana Sayfa</a></li>
                <li><a href="#about" class="nav-link page-link">Hakkımda</a></li>
                <li><a href="#services" class="nav-link page-link">Hizmetler</a></li>
                <li><a href="#blog" class="nav-link page-link">Blog</a></li>
                <li><a href="#contact" class="nav-link page-link">İletişim</a></li>
                <li><a href="#appointment" class="btn btn-primary mt-4 page-link">Randevu Al</a></li>
            </ul>
        </div>
    </header>

    <main class="mb-32 md:mb-48">
        <!-- Home Page Content -->
        <section id="home" class="page">
            <div class="container mx-auto px-6 py-24 md:py-32 flex flex-col md:flex-row items-center gap-12">
                <div class="md:w-1/2 text-center md:text-left">
                    <span id="home-subtitle" class="font-semibold text-primary uppercase tracking-wider skeleton animate-pulse w-1/2 h-5 mb-4 block"></span>
                    <h1 id="home-title" class="text-4xl md:text-6xl font-extrabold text-text-color-dark mt-4 mb-6 leading-tight skeleton animate-pulse h-24 rounded-lg"></h1>
                    <p id="home-description" class="text-lg text-text-color-light max-w-xl mx-auto md:mx-0 mb-8 skeleton animate-pulse h-16 rounded-lg"></p>
                    <div class="flex justify-center md:justify-start items-center gap-4">
                        <a href="#appointment" class="btn btn-primary page-link">Randevu Alın</a>
                        <a href="#services" class="btn btn-secondary page-link">Hizmetlerimiz</a>
                    </div>
                </div>
                <div class="md:w-1/2">
                    <div class="card p-2">
                        <div id="home-image-skeleton" class="w-full aspect-video skeleton animate-pulse rounded-xl"></div>
                        <img id="home-image" src="" class="rounded-xl hidden" alt="Modern bir fizyoterapi kliniği">
                    </div>
                </div>
            </div>
        </section>
        <!-- About Page Content -->
        <section id="about" class="page py-24 md:py-32">
             <div class="container mx-auto px-6">
                <div class="text-center mb-16 max-w-3xl mx-auto">
                    <h2 id="about-title" class="text-4xl md:text-5xl font-bold text-text-color-dark skeleton animate-pulse h-12 w-3/4 mx-auto rounded-lg"></h2>
                    <p id="about-subtitle" class="text-lg text-text-color-light mt-4 skeleton animate-pulse h-8 w-full mx-auto rounded-lg"></p>
                </div>
                <div class="grid md:grid-cols-2 gap-12 items-center">
                     <div class="card p-2">
                        <div id="about-image-skeleton" class="w-full aspect-square skeleton animate-pulse rounded-xl"></div>
                         <img id="about-image" src="" alt="Fizyoterapist Neşe Taş" class="rounded-xl w-full h-full object-cover hidden">
                     </div>
                     <div class="space-y-8">
                         <div class="card p-8"><h3 class="text-3xl font-bold text-text-color-dark mb-4">Deneyimlerim</h3><ul id="about-experiences" class="space-y-4"></ul></div>
                         <div class="card p-8"><h3 class="text-3xl font-bold text-text-color-dark mb-4">Eğitim & Sertifikalar</h3><ul id="about-educations" class="space-y-4"></ul></div>
                     </div>
                </div>
            </div>
        </section>
        <!-- Services Page Content -->
        <section id="services" class="page py-24 md:py-32">
            <div class="container mx-auto px-6">
                 <div class="text-center mb-16 max-w-3xl mx-auto"><h2 class="text-4xl md:text-5xl font-bold text-text-color-dark">Hizmetlerimiz</h2><p class="text-lg text-text-color-light mt-4">Sağlığınıza giden yolda size özel, modern ve kanıta dayalı çözümler.</p></div>
                 <div id="services-container" class="flex flex-wrap justify-center gap-8"></div>
             </div>
        </section>
        <!-- Blog Page Content -->
        <section id="blog" class="page py-24 md:py-32">
            <div class="container mx-auto px-6">
                 <div class="text-center mb-16 max-w-3xl mx-auto"><h2 class="text-4xl md:text-5xl font-bold text-text-color-dark">Blog</h2><p class="text-lg text-text-color-light mt-4">Sağlıklı yaşam ve fizyoterapi hakkında güncel, bilgilendirici yazılar.</p></div>
                <div id="blog-container" class="flex flex-wrap justify-center gap-8"></div>
            </div>
        </section>
        <!-- Contact Page Content -->
        <section id="contact" class="page py-24 md:py-32">
             <div class="container mx-auto px-6">
                 <div class="text-center mb-16 max-w-3xl mx-auto"><h2 class="text-4xl md:text-5xl font-bold text-text-color-dark">İletişimde Kalalım</h2><p class="text-lg text-text-color-light mt-4">Sorularınız, önerileriniz veya randevu talepleriniz için bize ulaşmaktan çekinmeyin.</p></div>
                 <div class="card p-8 md:p-12 flex flex-col lg:flex-row gap-12">
                     <div class="lg:w-1/2"><h3 class="text-3xl font-bold mb-6 text-text-color-dark">İletişim Bilgileri</h3><div class="space-y-6 text-lg text-gray-700"><p class="flex items-start"><i class="fas fa-map-marker-alt mt-1 mr-4 text-primary"></i><span id="contact-address"></span></p><p class="flex items-center"><i class="fas fa-phone mr-4 text-primary"></i><a id="contact-phone" href="" class="hover:text-primary"></a></p><p class="flex items-center"><i class="fas fa-envelope mr-4 text-primary"></i><a id="contact-email" href="" class="hover:text-primary"></a></p></div></div>
                     <div id="map-container" class="lg:w-1/2 min-h-[300px] lg:min-h-full rounded-xl overflow-hidden skeleton animate-pulse"></div>
                 </div>
             </div>
        </section>
        <!-- Appointment Page Content -->
        <section id="appointment" class="page py-24 md:py-32">
            <div class="container mx-auto px-6">
                <div class="max-w-2xl mx-auto card p-8 md:p-12">
                     <div class="text-center mb-8"><p class="text-primary font-semibold">Randevu Formu</p><h2 class="text-3xl md:text-4xl font-bold text-text-color-dark mt-1">Harekete Geçmek İçin Formu Doldurun</h2></div>
                     <form id="appointment-form" action="https://formspree.io/f/mqabbvab" method="POST">
                         <div class="space-y-6">
                             <input type="text" name="name" class="form-input" placeholder="Ad ve Soyad" required>
                             <input type="tel" name="phone" class="form-input" placeholder="Telefon Numarası*" required>
                             <input type="email" name="email" class="form-input" placeholder="E-posta" required>
                             <textarea name="message" rows="5" class="form-input" placeholder="Tedavi görmek istediğiniz konu..." required></textarea>
                             <div class="flex items-center">
                                 <input id="consent" name="consent" type="checkbox" required class="h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary">
                                 <label for="consent" class="ml-3 block text-sm text-text-color-light">Verilerin iletişim amacıyla işlenmesine izin veriyorum.*</label>
                             </div>
                             <button type="submit" id="form-submit-btn" class="w-full btn btn-primary text-lg">Randevu Talebi Gönder</button>
                         </div>
                         <p id="form-status" class="text-center mt-4"></p>
                     </form>
                </div>
            </div>
        </section>
    </main>
    
    <!-- Modallar -->
    <div id="blog-modal" class="modal"><div class="modal-content" style="max-width: 800px;"><span class="close-button">&times;</span><h2 id="modal-title" class="text-3xl font-bold text-text-color-dark mb-4"></h2><p id="modal-date" class="text-sm text-text-color-light mb-4"></p><img id="modal-image" src="" alt="Blog görseli" class="w-full h-64 object-cover rounded-xl mb-6"><div id="modal-body" class="text-lg text-gray-700 space-y-4"></div></div></div>
    <div id="password-modal" class="modal">
        <div class="modal-content" style="max-width: 400px;">
            <span class="close-button">&times;</span>
            <h3 class="text-2xl font-bold mb-4 text-center">Admin Girişi</h3>
            <form id="password-form" class="space-y-4">
                <input type="password" id="password-input" class="form-input text-center" placeholder="Şifreyi Girin" required>
                <button type="submit" class="w-full btn btn-primary">Giriş Yap</button>
            </form>
        </div>
    </div>
    <div id="admin-menu-modal" class="modal">
        <div class="modal-content admin-panel-base-scrollable" style="max-width: 400px;">
            <span class="close-button">&times;</span>
            <h3 class="text-2xl font-bold mb-6 text-center">Yönetim Menüsü</h3>
            <div class="space-y-6">
                <div>
                    <h4 class="font-bold text-lg mb-2 text-center text-primary">Sayfa İçerikleri</h4>
                     <div class="flex flex-col space-y-3">
                        <button id="open-home-edit-panel-btn" class="w-full btn btn-secondary">Anasayfa Düzenle</button>
                        <button id="open-about-edit-panel-btn" class="w-full btn btn-secondary">Hakkımda Düzenle</button>
                        <button id="open-contact-edit-panel-btn" class="w-full btn btn-secondary">İletişim Düzenle</button>
                    </div>
                </div>
                <div class="border-t pt-6">
                    <h4 class="font-bold text-lg mb-2 text-center text-primary">Blog Yönetimi</h4>
                    <div class="flex flex-col space-y-3">
                        <button id="open-create-panel-btn" class="w-full btn btn-primary">Blog Yazısı Oluştur</button>
                        <button id="open-edit-panel-btn" class="w-full btn btn-secondary">Blog Yazısı Düzenle</button>
                        <button id="open-delete-panel-btn" class="w-full btn btn-secondary !border-red-500 !text-red-500 hover:!bg-red-50">Blog Yazısı Sil</button>
                    </div>
                </div>
                <div class="border-t pt-6">
                     <h4 class="font-bold text-lg mb-2 text-center text-primary">Hizmet Yönetimi</h4>
                    <div class="flex flex-col space-y-3">
                        <button id="open-create-service-panel-btn" class="w-full btn btn-primary">Hizmet Ekle</button>
                        <button id="open-edit-service-panel-btn" class="w-full btn btn-secondary">Hizmet Düzenle</button>
                        <button id="open-delete-service-panel-btn" class="w-full btn btn-secondary !border-red-500 !text-red-500 hover:!bg-red-50">Hizmet Sil</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="edit-post-panel" class="admin-panel-base admin-panel-base-scrollable"><span class="close-button">&times;</span><h3 class="text-2xl font-bold mb-4">Yazı Düzenle</h3><div id="edit-post-list" class="space-y-3"></div></div>
    <div id="delete-post-panel" class="admin-panel-base admin-panel-base-scrollable"><span class="close-button">&times;</span><h3 class="text-2xl font-bold mb-4">Yazı Sil</h3><div id="delete-post-list" class="space-y-3"></div></div>
    <div id="edit-service-panel" class="admin-panel-base admin-panel-base-scrollable"><span class="close-button">&times;</span><h3 class="text-2xl font-bold mb-4">Hizmet Düzenle</h3><div id="edit-service-list" class="space-y-3"></div></div>
    <div id="delete-service-panel" class="admin-panel-base admin-panel-base-scrollable"><span class="close-button">&times;</span><h3 class="text-2xl font-bold mb-4">Hizmet Sil</h3><div id="delete-service-list" class="space-y-3"></div></div>
    
    <div id="confirmation-modal" class="modal">
        <div class="modal-content" style="max-width: 450px;">
            <h3 id="confirmation-title" class="text-xl font-bold mb-4 text-center">Bu öğeyi silmek istediğinize emin misiniz?</h3>
            <p class="text-center text-text-color-light mb-6">Bu işlem geri alınamaz.</p>
            <div class="flex justify-center gap-4">
                <button id="confirm-delete-btn" class="btn btn-primary !bg-red-600 hover:!bg-red-700 flex-1">Evet, Sil</button>
                <button id="cancel-delete-btn" class="btn btn-secondary flex-1">İptal</button>
            </div>
        </div>
    </div>

    <!-- Blog Oluşturma/Güncelleme Paneli -->
    <div id="admin-panel" class="admin-panel-base admin-panel-base-scrollable">
        <h3 id="admin-panel-title" class="text-2xl font-bold mb-4">Yeni Blog Yazısı Ekle</h3>
        <form id="add-post-form" class="space-y-4">
            <input type="hidden" id="post-id-input">
            <div><input type="text" id="post-title" class="form-input" placeholder="Yazı Başlığı" required maxlength="100" tabindex="1"><div id="post-title-counter" class="char-counter"></div></div>
            <div><input type="text" id="post-image" class="form-input" placeholder="Görsel URL" required maxlength="2048" tabindex="2"><div id="post-image-counter" class="char-counter"></div></div>
            <div><textarea id="post-summary" class="form-input" rows="3" placeholder="Özet (Kartta görünecek metin)" required maxlength="300" tabindex="3"></textarea><div id="post-summary-counter" class="char-counter"></div></div>
            <div><label class="block text-sm font-medium text-gray-700 mb-1">Yazının Tamamı</label><div id="editor-container" tabindex="4"><div id="post-editor"></div></div><div id="post-editor-counter" class="char-counter"></div></div>
            <div class="flex gap-4"><button type="submit" id="form-submit-button" class="btn btn-primary flex-1" tabindex="5">Yazıyı Ekle</button><button type="button" class="btn btn-secondary close-button" tabindex="6">Kapat</button></div>
        </form>
    </div>
    
     <!-- Sayfa İçerik Panelleri -->
    <div id="home-edit-panel" class="admin-panel-base"><span class="close-button">&times;</span><h3 class="text-2xl font-bold mb-4">Anasayfa İçeriklerini Düzenle</h3><form id="home-edit-form" class="space-y-4">
        <div><label class="font-semibold">Üst Başlık</label><input type="text" id="edit-home-subtitle" class="form-input" required maxlength="50"><div id="edit-home-subtitle-counter" class="char-counter"></div></div>
        <div><label class="font-semibold">Ana Başlık</label><input type="text" id="edit-home-title" class="form-input" required maxlength="80"><div id="edit-home-title-counter" class="char-counter"></div></div>
        <div><label class="font-semibold">Açıklama</label><textarea id="edit-home-description" class="form-input" rows="3" required maxlength="150"></textarea><div id="edit-home-description-counter" class="char-counter"></div></div>
        <div><label class="font-semibold">Görsel URL</label><input type="text" id="edit-home-image" class="form-input" required maxlength="2048"><div id="edit-home-image-counter" class="char-counter"></div></div>
        <button type="submit" class="btn btn-primary w-full">Değişiklikleri Kaydet</button>
    </form></div>

    <div id="about-edit-panel" class="admin-panel-base admin-panel-base-scrollable"><span class="close-button">&times;</span><h3 class="text-2xl font-bold mb-4">Hakkımda Sayfasını Düzenle</h3><form id="about-edit-form" class="space-y-6">
        <div><label class="font-semibold">Ana Başlık</label><input type="text" id="edit-about-title" class="form-input" required maxlength="50"><div id="edit-about-title-counter" class="char-counter"></div></div>
        <div><label class="font-semibold">Alt Başlık</label><input type="text" id="edit-about-subtitle" class="form-input" required maxlength="100"><div id="edit-about-subtitle-counter" class="char-counter"></div></div>
        <div><label class="font-semibold">Görsel URL</label><input type="text" id="edit-about-image" class="form-input" required maxlength="2048"><div id="edit-about-image-counter" class="char-counter"></div></div>
        <div class="border-t pt-4"><h4 class="font-semibold text-lg mb-2">Deneyimler</h4><div id="experiences-list-editor" class="space-y-3"></div><button type="button" id="add-experience-btn" class="btn btn-secondary !py-2 !px-4 mt-2">Deneyim Ekle</button></div>
        <div class="border-t pt-4"><h4 class="font-semibold text-lg mb-2">Eğitim & Sertifikalar</h4><div id="educations-list-editor" class="space-y-3"></div><button type="button" id="add-education-btn" class="btn btn-secondary !py-2 !px-4 mt-2">Eğitim Ekle</button></div>
        <button type="submit" class="btn btn-primary w-full">Değişiklikleri Kaydet</button>
    </form></div>
    
    <div id="contact-edit-panel" class="admin-panel-base"><span class="close-button">&times;</span><h3 class="text-2xl font-bold mb-4">İletişim Bilgilerini Düzenle</h3><form id="contact-edit-form" class="space-y-4">
        <div><label class="font-semibold">Telefon Numarası</label><input type="text" id="edit-contact-phone" class="form-input" required maxlength="30"><div id="edit-contact-phone-counter" class="char-counter"></div></div>
        <div><label class="font-semibold">E-posta Adresi</label><input type="email" id="edit-contact-email" class="form-input" required maxlength="100"><div id="edit-contact-email-counter" class="char-counter"></div></div>
        <div><label class="font-semibold">Adres</label><textarea id="edit-contact-address" class="form-input" rows="3" required maxlength="200"></textarea><div id="edit-contact-address-counter" class="char-counter"></div></div>
        <div><label class="font-semibold">Google Maps Gömme (iframe) Kodu</label><textarea id="edit-contact-map" class="form-input" rows="4" required maxlength="2048"></textarea><div id="edit-contact-map-counter" class="char-counter"></div></div>
        <button type="submit" class="btn btn-primary w-full">Değişiklikleri Kaydet</button>
    </form></div>

     <!-- Hizmet Oluşturma/Güncelleme Paneli -->
    <div id="service-panel" class="admin-panel-base">
        <h3 id="service-panel-title" class="text-2xl font-bold mb-4">Yeni Hizmet Ekle</h3>
        <form id="add-service-form" class="space-y-4">
            <input type="hidden" id="service-id-input">
             <div><input type="text" id="service-title" class="form-input" placeholder="Hizmet Başlığı" required maxlength="50" tabindex="1"><div id="service-title-counter" class="char-counter"></div></div>
            <div><input type="text" id="service-icon" class="form-input" placeholder="Font Awesome İkon Sınıfı (örn: fas fa-running)" required maxlength="50" tabindex="2"><div id="service-icon-counter" class="char-counter"></div></div>
            <div><textarea id="service-description" class="form-input" rows="4" placeholder="Hizmet Açıklaması" required maxlength="200" tabindex="3"></textarea><div id="service-description-counter" class="char-counter"></div></div>
            <div class="flex gap-4"><button type="submit" id="service-form-submit-button" class="btn btn-primary flex-1" tabindex="4">Hizmeti Ekle</button><button type="button" class="btn btn-secondary close-button" tabindex="5">Kapat</button></div>
        </form>
    </div>

    <!-- Footer -->
    <footer class="bg-gradient-to-r from-emerald-200 via-pink-100 to-white text-gray-700">
        <div class="container mx-auto px-6 py-20">
             <div class="text-center">
                 <a href="#home" class="text-2xl font-bold text-black page-link">Fizyoterapist Neşe Taş</a>
                 <div class="flex justify-center space-x-6 my-6">
                     <a href="https://www.instagram.com/fztnesetas/" target="_blank" class="hover:text-white transition-colors"><i class="fab fa-instagram fa-lg"></i></a>
                     <a href="https://tr.linkedin.com/in/nese-tas-10ba78199?trk=people-guest_profile-result-card_result-card_full-click" target="_blank" class="hover:text-white transition-colors"><i class="fab fa-linkedin fa-lg"></i></a>
                     <a href="https://www.tiktok.com/@fztnese" target="_blank" class="hover:text-white transition-colors"><i class="fab fa-tiktok fa-lg"></i></a>
                 </div>
             </div>
            <div class="mt-8 border-t border-gray-700 pt-8 text-center"><p>&copy; <span id="year"></span> Fizyoterapist Neşe Taş. Tüm hakları saklıdır.</p><div class="mt-4 max-w-3xl mx-auto"><p class="text-xs font-semibold">YASAL UYARI</p><p class="text-xs text-gray-500">Bu site sağlık hizmeti vermemektedir, kişileri bilgilendirmek ve site sahibi hakkında bilgi vermek amacı ile hazırlanmıştır. Sitedeki bilgiler hastalıkların tanı veya tedavisinde kullanılmak üzere verilmemiştir. Tanı ve tedaviler mutlaka bir hekim tarafından yapılması gereken işlemlerdir.</p></div></div>
        </div>
    </footer>
    
    <a href="https://wa.me/905424528803" target="_blank" class="whatsapp-fab" aria-label="WhatsApp üzerinden iletişime geçin">
        <i class="fab fa-whatsapp"></i>
    </a>

    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getAuth, signInAnonymously } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";
        import { getFirestore, collection, onSnapshot, getDocs, addDoc, updateDoc, doc, deleteDoc, serverTimestamp, setDoc, getDoc } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        
        // ÖNEMLİ: Kendi Firebase projenizin bilgilerini buraya yapıştırın.
        const firebaseConfig = {
            apiKey: "AIzaSyDOiyE7rwCnzrnm0gOWmJjhfWdCEOsVmLA",
            authDomain: "fzt-nese-tas.firebaseapp.com",
            projectId: "fzt-nese-tas",
            storageBucket: "fzt-nese-tas.appspot.com",
            messagingSenderId: "804311305704",
            appId: "1:804311305704:web:a23df4fa52273349b4a85d",
            measurementId: "G-TTKVLE8KVH"
        };

        // --- App Initialization ---
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getFirestore(app);

        // --- Global Variables ---
        const ADMIN_PASSWORD = 'admin';
        let quill;
        let itemToDelete = { id: null, type: null }; 
        let allBlogPosts = [];
        let allServices = [];
        let postsCollection, servicesCollection, pageContentCollection;
        
        // --- Element Getters ---
        const getEl = (id) => document.getElementById(id);
        
        function initializeQuill() {
            if (quill) return;

            quill = new Quill('#post-editor', {
                modules: { 
                    toolbar: [
                        [{ 'header': [1, 2, 3, false] }],
                        ['bold', 'italic', 'underline'],
                        [{ 'list': 'ordered'}, { 'list': 'bullet' }],
                        [{ 'color': [] }, { 'background': [] }],
                        ['clean']
                    ],
                    keyboard: {
                        bindings: {
                            tab: { key: 9, handler: () => getEl('form-submit-button').focus() }
                        }
                    }
                },
                placeholder: 'Yazınızı buraya yazın...',
                theme: 'snow'
            });

            quill.on('text-change', () => {
                updateQuillCounter();
            });
        }
        
        function createDynamicListItem(container, item = { title: '', subtitle: '' }) {
            const itemDiv = document.createElement('div');
            itemDiv.className = 'p-2 border rounded-md space-y-2 dynamic-list-item';
            itemDiv.innerHTML = `
                <input type="text" class="form-input" placeholder="Başlık (örn: Hastane Adı)" value="${item.title}" required>
                <input type="text" class="form-input" placeholder="Açıklama (örn: Pozisyon ve Yıl)" value="${item.subtitle}" required>
                <button type="button" class="text-red-500 text-sm font-semibold remove-list-item-btn">Kaldır</button>
            `;
            container.appendChild(itemDiv);
        }

        async function setupFirebase() {
            try {
                await signInAnonymously(auth);
                
                postsCollection = collection(db, "posts");
                servicesCollection = collection(db, "services");
                pageContentCollection = collection(db, "pageContent");

                await seedInitialData();
                
                setupPostsListener();
                setupServicesListener();
                setupPageContentListeners();

            } catch (error) {
                console.error("Authentication or setup failed:", error);
            }
        }
        
        async function seedInitialData() {
            const collectionsToSeed = [
                { ref: postsCollection, data: [
                    { title: 'Ofis Çalışanları İçin 5 Basit Egzersiz', date: new Date('2025-06-15T12:00:00Z'), image: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?q=80&w=1820&auto=format&fit=crop', summary: '...', fullContent: `<p>...</p>` }
                ]},
                { ref: servicesCollection, data: [
                    { title: 'Fizyoterapi', description: '...', icon: 'fas fa-running' }
                ]},
                { ref: pageContentCollection, docId: 'home', data: {
                    subtitle: 'Fizyoterapi & Sağlıklı Yaşam', title: 'Hareketin İyileştirici Gücünü Keşfedin.', description: '...', image: 'https://images.pexels.com/photos/4046655/pexels-photo-4046655.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1'
                }},
                { ref: pageContentCollection, docId: 'about', data: {
                    title: 'Fizyoterapist Neşe Taş', subtitle: 'İnsana ve harekete olan tutkumla...', image: 'https://images.pexels.com/photos/3912981/pexels-photo-3912981.jpeg?auto=compress&cs=tinysrgb&w=1260&h=750&dpr=1',
                    experiences: [{title: '[Hastane/Klinik Adı]', subtitle: 'Fizyoterapist (2020-Günümüz)'}],
                    educations: [{title: '[Üniversite Adı]', subtitle: 'Lisans'}, {title: 'Klinik Pilates Eğitmenliği', subtitle: 'Sertifika'}]
                }},
                 { ref: pageContentCollection, docId: 'contact', data: {
                    phone: '+90 (542) 452 88 03', email: 'info@fztnesetas.com', address: 'Barbaros, Ak Zambak Sok. ...', mapIframe: '<iframe src="https://www.google.com/maps/embed?pb=!1m18!1m12!1m3!1d6022.535625749074!2d29.099185048206603!3d40.99751108540818!2m3!1f0!2f0!3f0!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x14cac882ab345d37%3A0x9b4a2af9b2b902cf!2sVaryap%20Meridian%20A%20BLOK!5e0!3m2!1str!2sca!4v1750095719858!5m2!1str!2sca" width="100%" height="100%" style="border:0;" allowfullscreen="" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>'
                }}
            ];

            for (const seed of collectionsToSeed) {
                try {
                    const docRef = seed.docId ? doc(seed.ref, seed.docId) : null;
                    if (docRef) { // Single document seeding
                        const docSnap = await getDoc(docRef);
                        if (!docSnap.exists()) {
                            await setDoc(docRef, seed.data);
                        }
                    } else { // Collection seeding
                        const querySnapshot = await getDocs(seed.ref);
                        if (querySnapshot.empty) {
                            for (const item of seed.data) {
                                await addDoc(seed.ref, item);
                            }
                        }
                    }
                } catch(e) {
                    console.error("Error seeding data for ", seed, e);
                }
            }
        }

        // --- Firestore Real-time Listeners ---
        function setupPostsListener() {
            onSnapshot(postsCollection, (snapshot) => {
                allBlogPosts = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }))
                                            .sort((a, b) => (b.date?.toDate() || 0) - (a.date?.toDate() || 0));
                renderBlogPosts();
            }, (error) => console.error("Error listening to posts:", error));
        }

        function setupServicesListener() {
            onSnapshot(servicesCollection, (snapshot) => {
                allServices = snapshot.docs.map(doc => ({ id: doc.id, ...doc.data() }));
                renderServices();
            }, (error) => console.error("Error listening to services:", error));
        }
        
        function setupPageContentListeners() {
            onSnapshot(doc(pageContentCollection, 'home'), (doc) => {
                if(doc.exists()) {
                    const data = doc.data();
                    getEl('home-subtitle').textContent = data.subtitle;
                    getEl('home-title').textContent = data.title;
                    getEl('home-description').textContent = data.description;
                    getEl('home-image').src = data.image;
                    getEl('home-image').classList.remove('hidden');
                    getEl('home-image-skeleton').classList.add('hidden');
                    ['home-subtitle', 'home-title', 'home-description'].forEach(id => getEl(id).classList.remove('skeleton', 'animate-pulse', 'h-5', 'h-24', 'h-16', 'w-1/2', 'rounded-lg'));
                }
            });
            onSnapshot(doc(pageContentCollection, 'about'), (doc) => {
                if(doc.exists()) {
                    const data = doc.data();
                    getEl('about-title').textContent = data.title;
                    getEl('about-subtitle').textContent = data.subtitle;
                    getEl('about-image').src = data.image;
                    getEl('about-image').classList.remove('hidden');
                    getEl('about-image-skeleton').classList.add('hidden');
                     ['about-title', 'about-subtitle'].forEach(id => getEl(id).classList.remove('skeleton', 'animate-pulse', 'h-12', 'h-8', 'w-3/4', 'w-full', 'mx-auto', 'rounded-lg'));

                    const expContainer = getEl('about-experiences');
                    expContainer.innerHTML = '';
                    data.experiences?.forEach(item => {
                        expContainer.innerHTML += `<li class="flex items-start"><i class="fas fa-check-circle text-primary mt-1 mr-3"></i><span><strong>${item.title}</strong><br><span class="text-sm text-text-color-light">${item.subtitle}</span></span></li>`;
                    });
                    const eduContainer = getEl('about-educations');
                    eduContainer.innerHTML = '';
                    data.educations?.forEach(item => {
                        eduContainer.innerHTML += `<li class="flex items-start"><i class="fas fa-graduation-cap text-primary mt-1 mr-3"></i><span><strong>${item.title}</strong><br><span class="text-sm text-text-color-light">${item.subtitle}</span></span></li>`;
                    });
                }
            });
            onSnapshot(doc(pageContentCollection, 'contact'), (doc) => {
                if(doc.exists()) {
                    const data = doc.data();
                    const phoneEl = getEl('contact-phone');
                    const emailEl = getEl('contact-email');
                    phoneEl.textContent = data.phone;
                    phoneEl.href = `tel:${data.phone.replace(/\s/g, '')}`;
                    emailEl.textContent = data.email;
                    emailEl.href = `mailto:${data.email}`;
                    getEl('contact-address').textContent = data.address;
                    getEl('map-container').innerHTML = data.mapIframe;
                     getEl('map-container').classList.remove('skeleton', 'animate-pulse');
                }
            });
        }
        
        // --- UI Renderers ---
        function renderBlogPosts() {
            const blogContainer = getEl('blog-container');
            blogContainer.innerHTML = '';
            allBlogPosts.forEach(post => {
                const postDate = post.date?.toDate() || new Date();
                const formattedDate = postDate.toLocaleDateString('tr-TR', { day: 'numeric', month: 'long', year: 'numeric' });
                blogContainer.innerHTML += `
                    <div class="card w-full sm:w-2/3 md:w-2/5 lg:w-[31%] overflow-hidden group">
                        <div class="overflow-hidden h-56"><img src="${post.image}" onerror="this.src='https://placehold.co/600x400/e0e0e0/757575?text=G%C3%B6rsel+Bulunamad%C4%B1'" class="w-full h-full object-cover transition-transform duration-500 ease-in-out group-hover:scale-105" alt="${post.title}"></div>
                        <div class="p-6">
                            <p class="text-sm text-primary font-semibold mb-1">${formattedDate}</p>
                            <h3 class="text-xl font-bold text-text-color-dark mb-2">${post.title}</h3>
                            <p class="text-text-color-light text-sm mb-4 h-12 overflow-hidden">${post.summary}</p>
                            <button data-postid="${post.id}" class="read-more-btn font-semibold text-primary hover:text-primary-hover-color transition-colors">Devamını Oku <i class="fas fa-arrow-right ml-1"></i></button>
                        </div>
                    </div>`;
            });
        }

        function renderServices() {
            const servicesContainer = getEl('services-container');
            servicesContainer.innerHTML = '';
            allServices.forEach(service => {
                servicesContainer.innerHTML += `
                     <div class="card w-full sm:w-2/3 md:w-2/5 lg:w-[31%] p-8 text-center border-t-4 border-transparent hover:border-primary">
                        <div class="text-primary text-4xl mb-4"><i class="${service.icon}"></i></div>
                        <h3 class="text-2xl font-bold text-text-color-dark mb-2">${service.title}</h3>
                        <p class="text-text-color-light">${service.description}</p>
                    </div>`;
            });
        }
        
        // --- Page & Navigation Logic ---
        const pageLinks = document.querySelectorAll('.page-link');
        const pages = document.querySelectorAll('.page');
        const navLinks = document.querySelectorAll('.nav-link');
        
        function showPage(pageId) {
            pages.forEach(page => page.style.display = 'none');
            getEl(pageId)?.style.setProperty('display', 'block');
            navLinks.forEach(link => link.classList.toggle('active', link.hash === `#${pageId}`));
            window.scrollTo(0, 0);
        }
        pageLinks.forEach(link => { 
            link.addEventListener('click', (e) => { 
                e.preventDefault(); 
                showPage(link.hash.substring(1)); 
                getEl('mobile-menu').classList.add('hidden');
            }); 
        });
        getEl('mobile-menu-button').addEventListener('click', () => getEl('mobile-menu').classList.toggle('hidden'));
        getEl('year').textContent = new Date().getFullYear();

        // --- Modal & Panel Logic ---
        const modals = document.querySelectorAll('.modal, .admin-panel-base');
        function hideAllModals() {
            modals.forEach(m => m.style.display = 'none');
        }
        document.querySelectorAll('.close-button').forEach(button => button.addEventListener('click', hideAllModals));
        getEl('cancel-delete-btn').addEventListener('click', hideAllModals);

        // --- Admin Authentication ---
        const passwordModal = getEl('password-modal');
        document.addEventListener('keydown', (e) => {
            if (e.ctrlKey && e.shiftKey && e.key.toUpperCase() === 'P') {
                e.preventDefault();
                hideAllModals();
                passwordModal.style.display = 'block';
                getEl('password-input').focus();
            }
        });
        getEl('password-form').addEventListener('submit', (e) => {
            e.preventDefault();
            if (getEl('password-input').value === ADMIN_PASSWORD) {
                hideAllModals();
                getEl('admin-menu-modal').style.display = 'block';
            } else {
                showNotification('Hatalı şifre! Erişim reddedildi.', true);
            }
            getEl('password-input').value = '';
        });
        
        // --- Admin Menu Logic & Panel Openers ---
        const adminMenuActions = {
            'open-create-panel-btn': () => openPostPanel(),
            'open-edit-panel-btn': () => openListPanel('edit', 'post'),
            'open-delete-panel-btn': () => openListPanel('delete', 'post'),
            'open-create-service-panel-btn': () => openServicePanel(),
            'open-edit-service-panel-btn': () => openListPanel('edit', 'service'),
            'open-delete-service-panel-btn': () => openListPanel('delete', 'service'),
            'open-home-edit-panel-btn': () => openPageContentPanel('home'),
            'open-about-edit-panel-btn': () => openPageContentPanel('about'),
            'open-contact-edit-panel-btn': () => openPageContentPanel('contact')
        };
        Object.keys(adminMenuActions).forEach(id => getEl(id).addEventListener('click', adminMenuActions[id]));

        function openListPanel(action, type) {
            hideAllModals();
            const panel = getEl(`${action}-${type}-panel`);
            const listContainer = getEl(`${action}-${type}-list`);
            const items = type === 'post' ? allBlogPosts : allServices;
            
            listContainer.innerHTML = '';
            items.forEach(item => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'flex justify-between items-center p-3 bg-gray-50 rounded-lg';
                const actionText = action === 'edit' ? 'Düzenle' : 'Sil';
                const btnClass = action === 'edit' ? 'btn-primary' : '!border-red-500 !text-red-500 hover:!bg-red-50';
                itemDiv.innerHTML = `
                    <span class="truncate pr-4">${item.title}</span>
                    <button data-id="${item.id}" data-type="${type}" class="${action}-btn btn btn-sm ${btnClass} !px-4 !py-2">${actionText}</button>
                `;
                listContainer.appendChild(itemDiv);
            });
            panel.style.display = 'block';
        }

        // --- Event Delegation for Dynamic Buttons ---
        document.body.addEventListener('click', e => {
            const target = e.target;
            const editBtn = target.closest('.edit-btn');
            const deleteBtn = target.closest('.delete-btn');
            const readMoreBtn = target.closest('.read-more-btn');

            if (editBtn) {
                const { id, type } = editBtn.dataset;
                if (type === 'post') openPostPanel(id);
                if (type === 'service') openServicePanel(id);
            }
            if (deleteBtn) {
                itemToDelete = deleteBtn.dataset;
                getEl('confirmation-modal').style.display = 'block';
            }
            if(readMoreBtn) {
                 const postId = readMoreBtn.dataset.postid;
                 const post = allBlogPosts.find(p => p.id === postId);
                 if (post) {
                    const postDate = post.date?.toDate() || new Date();
                    const formattedDate = postDate.toLocaleDateString('tr-TR', { day: 'numeric', month: 'long', year: 'numeric'});
                    getEl('modal-title').innerText = post.title;
                    getEl('modal-date').innerText = formattedDate;
                    getEl('modal-image').src = post.image;
                    getEl('modal-body').innerHTML = post.fullContent;
                    getEl('blog-modal').style.display = "block";
                }
            }
             if (target.matches('.remove-list-item-btn')) {
                target.closest('.dynamic-list-item').remove();
            }
        });

        // --- Delete Confirmation ---
        getEl('confirm-delete-btn').addEventListener('click', async () => {
            if (itemToDelete.id && itemToDelete.type) {
                const collectionRef = itemToDelete.type === 'post' ? postsCollection : servicesCollection;
                try {
                    await deleteDoc(doc(collectionRef, itemToDelete.id));
                    hideAllModals();
                    showNotification('Öğe başarıyla silindi.', false);
                } catch(error) { showNotification('Öğe silinirken bir hata oluştu.', true); }
            }
        });
        
        // --- Character Counter Setup ---
        function setupCharCounter(elementId) {
            const input = getEl(elementId);
            if (!input) return; 
            const counter = getEl(`${elementId}-counter`);
            if (!counter) return; 
            const maxLength = input.maxLength;
            
            const updateCounter = () => {
                const currentLength = input.value.length;
                counter.textContent = `${currentLength} / ${maxLength}`;
                counter.classList.toggle('limit-exceeded', currentLength > maxLength);
            };
            input.addEventListener('input', updateCounter);
            updateCounter();
        }
        
        // DÜZELTME: Bu fonksiyonun tamamı güncellendi
        function updateQuillCounter() {
            if (!quill) return;
            const counter = getEl('post-editor-counter');
            const length = quill.getLength() - 1;
            const quillLimit = 10000;
            counter.textContent = `${length} / ${quillLimit}`;
            counter.classList.toggle('limit-exceeded', length > quillLimit);
        }

        // --- Page Content Edit Panels ---
        async function openPageContentPanel(pageName) {
            hideAllModals();
            const panel = getEl(`${pageName}-edit-panel`);
             try {
                const docRef = doc(pageContentCollection, pageName);
                const docSnap = await getDoc(docRef);
                
                if (docSnap.exists()) {
                    const data = docSnap.data();
                    if (pageName === 'home') {
                        getEl('edit-home-title').value = data.title;
                        getEl('edit-home-subtitle').value = data.subtitle;
                        getEl('edit-home-description').value = data.description;
                        getEl('edit-home-image').value = data.image;
                    } else if (pageName === 'about') {
                         getEl('edit-about-title').value = data.title;
                         getEl('edit-about-subtitle').value = data.subtitle;
                         getEl('edit-about-image').value = data.image;
                         const expContainer = getEl('experiences-list-editor');
                         expContainer.innerHTML = '';
                         data.experiences.forEach(item => createDynamicListItem(expContainer, item));
                         const eduContainer = getEl('educations-list-editor');
                         eduContainer.innerHTML = '';
                         data.educations.forEach(item => createDynamicListItem(eduContainer, item));
                    } else if (pageName === 'contact') {
                         getEl('edit-contact-phone').value = data.phone;
                         getEl('edit-contact-email').value = data.email;
                         getEl('edit-contact-address').value = data.address;
                         getEl('edit-contact-map').value = data.mapIframe;
                    }
                }
            } catch (error) {
                console.error("Error getting page content:", error);
            }
            
            panel.querySelectorAll('input, textarea').forEach(el => {
                if(el.id) setupCharCounter(el.id);
            });
            panel.style.display = 'block';
        }
        
        // --- Dynamic list buttons for About panel ---
        getEl('add-experience-btn').addEventListener('click', () => createDynamicListItem(getEl('experiences-list-editor')));
        getEl('add-education-btn').addEventListener('click', () => createDynamicListItem(getEl('educations-list-editor')));
        
        // --- Form Submit Handlers ---
        getEl('home-edit-form').addEventListener('submit', (e) => { e.preventDefault(); saveData('home'); });
        getEl('about-edit-form').addEventListener('submit', (e) => { e.preventDefault(); saveData('about'); });
        getEl('contact-edit-form').addEventListener('submit', (e) => { e.preventDefault(); saveData('contact'); });

        async function saveData(pageName) {
            let data = {};
            if (pageName === 'home') {
                data = {
                    title: getEl('edit-home-title').value,
                    subtitle: getEl('edit-home-subtitle').value,
                    description: getEl('edit-home-description').value,
                    image: getEl('edit-home-image').value,
                };
            } else if (pageName === 'about') {
                 data = {
                    title: getEl('edit-about-title').value,
                    subtitle: getEl('edit-about-subtitle').value,
                    image: getEl('edit-about-image').value,
                    experiences: Array.from(getEl('experiences-list-editor').children).map(item => ({
                        title: item.children[0].value,
                        subtitle: item.children[1].value
                    })),
                    educations: Array.from(getEl('educations-list-editor').children).map(item => ({
                        title: item.children[0].value,
                        subtitle: item.children[1].value
                    }))
                 };
            } else if(pageName === 'contact') {
                data = {
                    phone: getEl('edit-contact-phone').value,
                    email: getEl('edit-contact-email').value,
                    address: getEl('edit-contact-address').value,
                    mapIframe: getEl('edit-contact-map').value
                };
            }

            try {
                await setDoc(doc(pageContentCollection, pageName), data);
                hideAllModals();
                showNotification(`${pageName} sayfası başarıyla güncellendi.`);
            } catch(error) {
                showNotification('Kaydederken bir hata oluştu.', true);
            }
        }

        // --- CRUD Panels (Service & Post) ---
        function openServicePanel(id = null) {
            hideAllModals();
            const form = getEl('add-service-form');
            form.reset();
            const isEditing = !!id;
            getEl('service-panel-title').innerText = isEditing ? 'Hizmet Düzenle' : 'Yeni Hizmet Ekle';
            getEl('service-form-submit-button').innerText = isEditing ? 'Hizmeti Güncelle' : 'Hizmeti Ekle';
            getEl('service-id-input').value = id || '';
            if (isEditing) {
                const service = allServices.find(s => s.id === id);
                Object.keys(service).forEach(key => {
                    const el = getEl(`service-${key}`);
                    if (el) el.value = service[key];
                });
            }
            ['service-title', 'service-icon', 'service-description'].forEach(setupCharCounter);
            getEl('service-panel').style.display = 'block';
        }
        getEl('add-service-form').addEventListener('submit', async e => {
            e.preventDefault();
            const id = getEl('service-id-input').value;
            const data = {
                title: getEl('service-title').value,
                icon: getEl('service-icon').value,
                description: getEl('service-description').value
            };
            try {
                if (id) await updateDoc(doc(servicesCollection, id), data);
                else await addDoc(servicesCollection, data);
                hideAllModals();
                showNotification(`Hizmet başarıyla ${id ? 'güncellendi' : 'eklendi'}.`, false);
            } catch (error) {
                showNotification('Hizmet kaydedilirken hata oluştu.', true);
            }
        });

        function openPostPanel(id = null) {
            hideAllModals();
            getEl('add-post-form').reset();
            const isEditing = !!id;
            getEl('admin-panel-title').innerText = isEditing ? 'Blog Yazısını Güncelle' : 'Yeni Blog Yazısı Ekle';
            getEl('form-submit-button').innerText = isEditing ? 'Yazıyı Güncelle' : 'Yazıyı Ekle';
            getEl('post-id-input').value = id || '';
            
            initializeQuill();

            if (isEditing) {
                const post = allBlogPosts.find(p => p.id === id);
                getEl('post-title').value = post.title;
                getEl('post-image').value = post.image;
                getEl('post-summary').value = post.summary;
                quill.root.innerHTML = post.fullContent;
            } else {
                 quill.setText('');
            }
            ['post-title', 'post-image', 'post-summary'].forEach(setupCharCounter);
            updateQuillCounter();
            getEl('admin-panel').style.display = 'block';
        }
        getEl('add-post-form').addEventListener('submit', async e => {
            e.preventDefault();
            const id = getEl('post-id-input').value;
            const data = {
                title: getEl('post-title').value,
                image: getEl('post-image').value,
                summary: getEl('post-summary').value,
                fullContent: quill.root.innerHTML,
                date: id ? allBlogPosts.find(p => p.id === id).date : serverTimestamp()
            };
             try {
                if (id) await updateDoc(doc(postsCollection, id), data);
                else await addDoc(postsCollection, data);
                hideAllModals();
                showNotification(`Yazı başarıyla ${id ? 'güncellendi' : 'eklendi'}.`, false);
            } catch (error) {
                showNotification('Yazı kaydedilirken hata oluştu.', true);
            }
        });

        // --- Formspree AJAX Submission ---
        getEl('appointment-form').addEventListener('submit', async function (e) {
            e.preventDefault();
            const form = e.target;
            const data = new FormData(form);
            const statusEl = getEl('form-status');
            const submitBtn = getEl('form-submit-btn');
            
            submitBtn.disabled = true;
            submitBtn.textContent = "Gönderiliyor...";
            statusEl.textContent = "";
            try {
                const response = await fetch(form.action, {
                    method: form.method,
                    body: data,
                    headers: { 'Accept': 'application/json' }
                });
                if (response.ok) {
                    statusEl.textContent = "Teşekkürler! Randevu talebiniz alınmıştır.";
                    statusEl.className = "text-center mt-4 text-green-600";
                    form.reset();
                } else {
                     const responseData = await response.json();
                     statusEl.textContent = responseData.errors ? responseData.errors.map(error => error.message).join(", ") : "Bir hata oluştu.";
                     statusEl.className = "text-center mt-4 text-red-600";
                }
            } catch (error) {
                statusEl.textContent = "Bir ağ hatası oluştu, lütfen tekrar deneyin.";
                statusEl.className = "text-center mt-4 text-red-600";
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = "Randevu Talebi Gönder";
            }
        });

        // --- Helper Functions ---
        function showNotification(message, isError = false) {
            const notification = document.createElement('div');
            notification.textContent = message;
            notification.className = 'notification';
            notification.style.backgroundColor = isError ? '#ef4444' : '#22c55e';
            document.body.appendChild(notification);
            setTimeout(() => { notification.classList.add('show'); }, 10);
            setTimeout(() => {
                notification.classList.remove('show');
                setTimeout(() => { if(document.body.contains(notification)) document.body.removeChild(notification); }, 300);
            }, 3000);
        }
        
        // --- Initial Load ---
        setupFirebase();
        showPage('home');
    </script>
</body>
</html>
